@page "{announceId}"
@model Transportation.Web.Pages.DashBoard.Contracts.PendingRequestsModel
@{
    ViewData["Title"] = "پیشنهاد های بار";
}
@if (ViewData["IsSuccess"] != null)
{
                <div class="alert alert-success col-md-8">
                    <p class="help-block">پیشنهاد راننده با موفقیت تایید شد. در حال انتقال به صفحه ی اصلی...</p>
                </div>

                <script>
                    var delay = 3000;
                        setTimeout(function () { window.location = "https://localhost:44341/DashBoard"; }, delay);
                </script>
}

<div class="row">
                        <div class="col">
                            <div class="card shadow mb-4">
                                <div class="card-header d-flex justify-content-between align-items-center" style="color: rgb(133, 135, 150);">
                                    <h6 class="text-primary fw-bold m-0">پیشنهادات به اعلام بار شماره @ViewData["AnnounceId"]</h6>
                                    <div class="dropdown no-arrow"><button class="btn btn-link btn-sm dropdown-toggle" aria-expanded="false" data-bs-toggle="dropdown" type="button"><i class="fas fa-ellipsis-v text-gray-400"></i></button>
                                        <div class="dropdown-menu shadow dropdown-menu-end animated--fade-in">
                                            <p class="text-center dropdown-header">dropdown header:</p><a class="dropdown-item" href="#">&nbsp;Action</a><a class="dropdown-item" href="#">&nbsp;Another action</a>
                                            <div class="dropdown-divider"></div><a class="dropdown-item" href="#">&nbsp;Something else here</a>
                                        </div>
                                    </div>
                                </div><!-- Start: #000000001 -->
                                @if(ViewData["IsContractSigned"] != null)
                                {
                                    <div class="alert alert-warning">
                                        !حواله ی این اعلام بار ثبت شده و امکان تایید یا رد پیشنهاد وجود ندارد
                                    </div>
                                }
                                @if(ViewData["IsExistRequests"] == null)
                                {
                                    <table class="table table-striped table-bordered table-hover dataTable no-footer">
                                         <thead>
                                        <tr>
                                            <th>تاریخ ثبت</th>
                                            <th>نام متصدی</th>
                                            <th>نام راننده</th>
                                            <th>نوع بار</th>
                                            <th>مبدا</th>
                                            <th>مقصد</th>
                                            <th>پیشنهاد (ریال)</th>
                                    @if (ViewData["IsContractSigned"] == null)
                                    {
                                            <th>دستورات</th>
                                    }
                                        </tr>
                                    </thead>
                                    <tbody>
                                    @foreach (var request in Model.Requests)
                                    {
                                                <tr>
                                                   <td>@request.CreateDate.PersianDateTime()</td>
                                                   <td>@request.Announce.Contractor.User.UserName</td>
                                                   <td>@request.Driver.User.UserName</td>
                                                   <td>@request.Announce.CargoType</td>
                                                   <td>@request.Announce.Beginning</td>
                                                   <td>@request.Announce.Destination</td>
                                                   <td>@request.OfferPrice.ToString("#,0")</td>
                                    @if (ViewData["IsContractSigned"] == null)
                                    {
                                                   <td>
                                                       <a class="btn btn-primary" asp-page-handler="AcceptOffer" asp-route-requestId="@request.RequestId" style="background: #76DA54;">تایید پیشنهاد</a>
                                                       <a class="btn btn-primary" asp-page-handler="DeclineOffer" asp-route-requestId="@request.RequestId" style="background: rgb(145,36,12);">رد پیشنهاد</a>
                                                   </td>
                                    }
                                                </tr>
                                    }
                                    </tbody>
                                </table>
                                }
                                else
                                {
                                    <div class="alert alert-warning">
                                        !هیچ پیشنهادی برای این اعلام بار ثبت نشده
                                    </div>
                                }
                            </div>
                        </div>
                    </div>